
plugins {
	id 'java'
	id 'application'
	id 'java-library'
	id 'eclipse'
	id 'org.openjfx.javafxplugin' version '0.0.7'
}

sourceCompatibility = '12'
targetCompatibility = '12'

group = 'zone.wim'
version = '0.0.1'

application {
	mainClassName = 'zone.wim.library.Library'
}

javafx {
    modules = [ 'javafx.controls' ]
}

jar {
    manifest {
        attributes 'Implementation-Title': 'World Information Map',
                   'Implementation-Version': 0.1,
                   'Main-Class': 'zone.wim.library.Library'
    }
}
	
task enhance(type: JavaExec) {
  main = 'com.objectdb.Enhancer'
  classpath = sourceSets.main.runtimeClasspath
  args '-cp', 'src/main/java', 'app.model.*', 'app.model_dir_two.*'
}

compileJava.finalizedBy(enhance)

test {
	useJUnitPlatform()
	testLogging {
        // Show that tests are run in the command-line output
        events 'started', 'passed'
    }
}

sourceSets {
    test {
    	java {
        	srcDirs = [file('src/test/unit/java')]
        	resources.srcDirs = [file('src/test/unit/resources')]
    	}
    }
    
    integTest {
    	java.srcDir file('src/test/integration/java')
    	resources.srcDir file('src/test/integration/java')
    }
}

repositories {
    jcenter()
    mavenCentral()   
	maven {
		url 'https://codewizards.co/maven/release'
		url 'https://oss.sonatype.org/content/repositories/snapshots'
		url 'http://download.osgeo.org/webdav/geotools/'
		url 'http://m2.objectdb.com'
	}
}

dependencies {
    // apache commons
    implementation group: 'commons-codec', name: 'commons-codec', version:'1.0.15'
	implementation group: 'commons-validator', name: 'commons-validator', version: '1.6'
    implementation group: 'commons-daemon', name: 'commons-daemon', version: '1.1.0'
    implementation group: 'org.apache.tika', name: 'tika-core', version: '1.22'
    implementation group: 'org.apache.commons', name: 'commons-collections4', version: '4.3'
	
	implementation group: 'info.picocli', name: 'picocli', version: '4.0.0'
	annotationProcessor group: 'info.picocli', name: 'picocli-codegen', version: '4.0.0'
	
	// persistence API (JPA & JDO)
	implementation group: 'javax.persistence', name: 'javax.persistence-api', version: '2.2'
	implementation group: 'javax.transaction', name: 'javax.transaction-api', version: '1.3'
	compile group: 'javax.jdo', name: 'jdo-api', version: '3.1'
	
	// persistence implementations
	implementation group: 'com.objectdb', name: 'objectdb', version: '2.8.1'
	
	// networking
    api group: 'io.netty', name: 'netty-all', version:'4.1.34.Final'

	// encryption
    implementation group: 'org.bouncycastle', name: 'bcprov-jdk15on', version: '1.59'
	implementation group: 'org.bouncycastle', name: 'bcpg-jdk15on', version: '1.59'
	implementation group: 'name.neuhalfen.projects.crypto.bouncycastle.openpgp', name: 'bouncy-gpg', version: '2.+'
	//implementation group: 'org.bouncycastle', name: 'org.bouncycastle.openpgp.wot' , version: '1.56.1'
	
    implementation group: 'net.sf.jwordnet', name: 'jwnl', version:'1.4_rc3'
    implementation group: 'edu.mit', name: 'jwi', version:'2.2.3'
	
	implementation group: 'com.ibm.icu', name: 'icu4j', version: '63.1'
	
    implementation group: 'com.googlecode.blacken', name: 'blacken-core', version:'1.1.1'
    implementation group: 'org.apache.tika', name: 'tika-parsers', version:'1.18'
    implementation group: 'io.github.classgraph', name: 'classgraph', version:'4.0.4'
	
	// testing	
    testImplementation "org.jmockit:jmockit:1.+"    
	testImplementation 'org.junit.jupiter:junit-jupiter-api:5.4.1'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.4.1'
}

//test {
//    jvmArgs "-javaagent:${classpath.find { it.name.contains("jmockit") }.absolutePath}"
//}